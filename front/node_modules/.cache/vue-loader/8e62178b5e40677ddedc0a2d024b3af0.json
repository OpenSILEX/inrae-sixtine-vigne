{"remainingRequest":"/home/charlero/GIT/GITLAB/opensilex-dev/inrae-sixtine/front/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/charlero/GIT/GITLAB/opensilex-dev/inrae-sixtine/front/src/components/layout/ForgotPassword.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/home/charlero/GIT/GITLAB/opensilex-dev/inrae-sixtine/front/src/components/layout/ForgotPassword.vue","mtime":1636714207126},{"path":"/home/charlero/GIT/GITLAB/opensilex-dev/inrae-sixtine/front/node_modules/cache-loader/dist/cjs.js","mtime":1635245896600},{"path":"/home/charlero/GIT/GITLAB/opensilex-dev/inrae-sixtine/front/node_modules/thread-loader/dist/cjs.js","mtime":1635245896598},{"path":"/home/charlero/GIT/GITLAB/opensilex-dev/inrae-sixtine/front/node_modules/babel-loader/lib/index.js","mtime":1635246894104},{"path":"/home/charlero/GIT/GITLAB/opensilex-dev/inrae-sixtine/front/node_modules/ts-loader/index.js","mtime":1635245901572},{"path":"/home/charlero/GIT/GITLAB/opensilex-dev/inrae-sixtine/front/node_modules/cache-loader/dist/cjs.js","mtime":1635245896600},{"path":"/home/charlero/GIT/GITLAB/opensilex-dev/inrae-sixtine/front/node_modules/vue-loader/lib/index.js","mtime":1635246896232}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgppbXBvcnQgeyBDb21wb25lbnQsIFJlZiB9IGZyb20gInZ1ZS1wcm9wZXJ0eS1kZWNvcmF0b3IiOwppbXBvcnQgVnVlIGZyb20gInZ1ZSI7CmltcG9ydCBPcGVuU2lsZXhWdWVQbHVnaW4gZnJvbSAiLi4vLi4vLi4vLi4vLi4vb3BlbnNpbGV4LWZyb250L2Zyb250L3NyYy9tb2RlbHMvT3BlblNpbGV4VnVlUGx1Z2luIjsKLy8gQHRzLWlnbm9yZQppbXBvcnQgeyBBdXRoZW50aWNhdGlvblNlcnZpY2UgfSBmcm9tICJvcGVuc2lsZXgtc2VjdXJpdHkvaW5kZXgiOwovLyBAdHMtaWdub3JlCmltcG9ydCBIdHRwUmVzcG9uc2UsIHsgT3BlblNpbGV4UmVzcG9uc2UgfSBmcm9tICJvcGVuc2lsZXgtc2VjdXJpdHkvSHR0cFJlc3BvbnNlIjsKCkBDb21wb25lbnQKZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9yZ290UGFzc3dvcmQgZXh0ZW5kcyBWdWUgewogIGVtYWlsOiBzdHJpbmcgPSBudWxsOwogICR0OiBhbnk7CiAgJHN0b3JlOiBhbnk7CiAgJHJvdXRlcjogYW55OwogICRvcGVuc2lsZXg6IE9wZW5TaWxleFZ1ZVBsdWdpbjsKCiAgZ2V0IHVzZXIoKSB7CiAgICByZXR1cm4gdGhpcy4kc3RvcmUuc3RhdGUudXNlcjsKICB9CgogIHN0YXRpYyBhc3luYyBhc3luY0luaXQoJG9wZW5zaWxleDogT3BlblNpbGV4VnVlUGx1Z2luKSB7CiAgICBhd2FpdCAkb3BlbnNpbGV4LmxvYWRTZXJ2aWNlKCJvcGVuc2lsZXgtc2VjdXJpdHkuQXV0aGVudGljYXRpb25TZXJ2aWNlIik7CiAgfQoKICBAUmVmKCJ2YWxpZGF0b3JSZWYiKSByZWFkb25seSB2YWxpZGF0b3JSZWYhOiBhbnk7CgogIG9uUmVzZXRQYXNzd29yZEJ5RW1haWwoKSB7CiAgICBsZXQgdmFsaWRhdG9yUmVmOiBhbnkgPSB0aGlzLnZhbGlkYXRvclJlZjsKICAgIHZhbGlkYXRvclJlZi52YWxpZGF0ZSgpLnRoZW4oKGlzVmFsaWQpID0+IHsKICAgICAgaWYgKGlzVmFsaWQpIHsKICAgICAgICB0aGlzLnJlc2V0UGFzc3dvcmRCeUVtYWlsKCk7CiAgICAgIH0KICAgIH0pOwogIH0KCiAgcmVzZXRQYXNzd29yZEJ5RW1haWwoKSB7CiAgICB0aGlzLiRvcGVuc2lsZXgKICAgICAgLmdldFNlcnZpY2U8QXV0aGVudGljYXRpb25TZXJ2aWNlPigKICAgICAgICAib3BlbnNpbGV4LXNlY3VyaXR5LkF1dGhlbnRpY2F0aW9uU2VydmljZSIKICAgICAgKQogICAgICAuZm9yZ290UGFzc3dvcmQodGhpcy5lbWFpbCkKICAgICAgLnRoZW4oKGh0dHA6IEh0dHBSZXNwb25zZTxPcGVuU2lsZXhSZXNwb25zZTxhbnk+PikgPT4gewogICAgICAgIHRoaXMuJG9wZW5zaWxleC5zaG93U3VjY2Vzc1RvYXN0V2l0aERlbGF5KAogICAgICAgICAgdGhpcy4kdCgiRm9yZ290UGFzc3dvcmRDb21wb25lbnQubGluay1lbWFpbCIpLAogICAgICAgICAgNTAwMAogICAgICAgICk7CiAgICAgIH0pCiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICBpZiAoZXJyb3Iuc3RhdHVzID09IDUwMykgewogICAgICAgICAgY29uc29sZS5lcnJvcigiU2VydmljZSBub3QgYXZhaWxhYmxlIiwgZXJyb3IpOwogICAgICAgICAgdGhpcy4kb3BlbnNpbGV4LmVycm9ySGFuZGxlcigKICAgICAgICAgICAgZXJyb3IsCiAgICAgICAgICAgIHRoaXMuJHQoIkZvcmdvdFBhc3N3b3JkQ29tcG9uZW50LnNlcnZpY2Utbm90LWF2YWlsYWJsZSIpCiAgICAgICAgICApOwogICAgICAgIH0gZWxzZSBpZiAoZXJyb3Iuc3RhdHVzID09IDQwMyB8fCBlcnJvci5zdGF0dXMgPT0gNTAwKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCJJbnZhbGlkIGNyZWRlbnRpYWxzIiwgZXJyb3IpOwogICAgICAgICAgdGhpcy4kb3BlbnNpbGV4LmVycm9ySGFuZGxlcigKICAgICAgICAgICAgZXJyb3IsCiAgICAgICAgICAgIHRoaXMuJHQoIkZvcmdvdFBhc3N3b3JkQ29tcG9uZW50LmludmFsaWQtaWRlbnRpZmllciIpCiAgICAgICAgICApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgICAgICB0aGlzLiRvcGVuc2lsZXguZXJyb3JIYW5kbGVyKGVycm9yKTsKICAgICAgICB9CiAgICAgICAgdGhpcy4kb3BlbnNpbGV4LmhpZGVMb2FkZXIoKTsKICAgICAgfSk7CiAgfQp9Cg=="},{"version":3,"sources":["ForgotPassword.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ForgotPassword.vue","sourceRoot":"src/components/layout","sourcesContent":["<template>\n  <div class=\"container-fluid\">\n    <b-row>\n      <b-col></b-col>\n      <b-col cols=\"8\">\n        <h3>{{ $t(\"ForgotPasswordComponent.title\") }}</h3>\n        <br />\n        <div>\n          <p>\n            {{ $t(\"ForgotPasswordComponent.steps\") }}\n          </p>\n          <ol class=\"list-unstyled\">\n            <li>\n              <span class=\"text-primary text-medium\">1. </span\n              >{{ $t(\"ForgotPasswordComponent.step-one\") }}\n            </li>\n            <li>\n              <span class=\"text-primary text-medium\">2. </span\n              >{{ $t(\"ForgotPasswordComponent.step-two\") }}\n            </li>\n            <li>\n              <span class=\"text-primary text-medium\">3. </span\n              >{{ $t(\"ForgotPasswordComponent.step-three\") }}\n            </li>\n          </ol>\n        </div>\n        <br />\n        <ValidationObserver ref=\"validatorRef\">\n          <b-form @submit.prevent=\"onResetPasswordByEmail\">\n            <!-- Email -->\n            <opensilex-InputForm\n              :value.sync=\"email\"\n              label=\"ForgotPasswordComponent.enter-email\"\n              type=\"email\"\n              :required=\"true\"\n              rules=\"email\"\n              placeholder=\"component.user.form-email-placeholder\"\n            ></opensilex-InputForm>\n\n            <b-row>\n              <b-col>\n                <b-button\n                  type=\"submit\"\n                  variant=\"primary\"\n                  v-text=\"$t('ForgotPasswordComponent.reset-password')\"\n                ></b-button>\n              </b-col>\n              <b-col>\n                <router-link :to=\"{ path: '/' }\"\n                  ><b-button\n                    variant=\"secondary\"\n                    v-text=\"$t('ForgotPasswordComponent.returnHome')\"\n                  ></b-button\n                ></router-link>\n              </b-col>\n            </b-row>\n          </b-form>\n        </ValidationObserver>\n      </b-col>\n      <b-col cols=\"3\"></b-col>\n    </b-row>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { Component, Ref } from \"vue-property-decorator\";\nimport Vue from \"vue\";\nimport OpenSilexVuePlugin from \"../../../../../opensilex-front/front/src/models/OpenSilexVuePlugin\";\n// @ts-ignore\nimport { AuthenticationService } from \"opensilex-security/index\";\n// @ts-ignore\nimport HttpResponse, { OpenSilexResponse } from \"opensilex-security/HttpResponse\";\n\n@Component\nexport default class ForgotPassword extends Vue {\n  email: string = null;\n  $t: any;\n  $store: any;\n  $router: any;\n  $opensilex: OpenSilexVuePlugin;\n\n  get user() {\n    return this.$store.state.user;\n  }\n\n  static async asyncInit($opensilex: OpenSilexVuePlugin) {\n    await $opensilex.loadService(\"opensilex-security.AuthenticationService\");\n  }\n\n  @Ref(\"validatorRef\") readonly validatorRef!: any;\n\n  onResetPasswordByEmail() {\n    let validatorRef: any = this.validatorRef;\n    validatorRef.validate().then((isValid) => {\n      if (isValid) {\n        this.resetPasswordByEmail();\n      }\n    });\n  }\n\n  resetPasswordByEmail() {\n    this.$opensilex\n      .getService<AuthenticationService>(\n        \"opensilex-security.AuthenticationService\"\n      )\n      .forgotPassword(this.email)\n      .then((http: HttpResponse<OpenSilexResponse<any>>) => {\n        this.$opensilex.showSuccessToastWithDelay(\n          this.$t(\"ForgotPasswordComponent.link-email\"),\n          5000\n        );\n      })\n      .catch((error) => {\n        if (error.status == 503) {\n          console.error(\"Service not available\", error);\n          this.$opensilex.errorHandler(\n            error,\n            this.$t(\"ForgotPasswordComponent.service-not-available\")\n          );\n        } else if (error.status == 403 || error.status == 500) {\n          console.error(\"Invalid credentials\", error);\n          this.$opensilex.errorHandler(\n            error,\n            this.$t(\"ForgotPasswordComponent.invalid-identifier\")\n          );\n        } else {\n          console.log(error);\n          this.$opensilex.errorHandler(error);\n        }\n        this.$opensilex.hideLoader();\n      });\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n</style>\n\n<i18n>\n  en:\n    ForgotPasswordComponent:\n      title: \"Forgot password ?\"\n      enter-email: Enter the e-mail linked to your account\n      reset-password: Send an e-mail to this adress\n      steps: \"Change your password in three easy steps. This will help you to secure your password!\"\n      step-one: \"Enter your email address below.\"\n      step-two: \"Our system will send you a temporary link.\"\n      step-three: \"Use the link to reset your password.\"\n      service-not-available: Service not available\n      invalid-identifier: Identifiant invalide\n      link-email: An e-mail has been sent to you\n      returnHome: return to homepage\n  fr:\n    ForgotPasswordComponent:\n      title: \"Mot de passe oublié ?\"\n      enter-email: Entrez l'adresse e-mail liée à votre compte\n      reset-password: Envoyer un e-mail à cette adresse\n      steps: \"Changez votre mot de passe en trois étapes simples. Cela vous aidera à sécuriser votre mot de passe !\"\n      step-one: \"Saisissez votre adresse électronique ci-dessous.\"\n      step-two: \"Notre système vous enverra un lien temporaire.\"\n      step-three: \"Utilisez le lien pour réinitialiser votre mot de passe.\"\n      service-not-available: Service not available\n      invalid-identifier: Identifiant invalide\n      link-email: Un email vous a été envoyé\n      returnHome: Retourner à la page d'acceuil\n</i18n>\n"]}]}